<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ekaterina Cvetkova">
<meta name="author" content="Nikola Kostadinov">
<meta name="dcterms.date" content="2025-06-07">

<title>Mauna Loa CO2 Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="preprocessing_files/libs/clipboard/clipboard.min.js"></script>
<script src="preprocessing_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="preprocessing_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="preprocessing_files/libs/quarto-html/popper.min.js"></script>
<script src="preprocessing_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="preprocessing_files/libs/quarto-html/anchor.min.js"></script>
<link href="preprocessing_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="preprocessing_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="preprocessing_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="preprocessing_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="preprocessing_files/libs/bootstrap/bootstrap-bb462d781dde1847d9e3ccf7736099dd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#importation-of-dataset---co₂-carbon-dioxide" id="toc-importation-of-dataset---co₂-carbon-dioxide" class="nav-link" data-scroll-target="#importation-of-dataset---co₂-carbon-dioxide"><span class="header-section-number">1.1</span> Importation of Dataset - CO₂ (Carbon Dioxide)</a></li>
  </ul></li>
  <li><a href="#cleaning-and-organizing-data" id="toc-cleaning-and-organizing-data" class="nav-link" data-scroll-target="#cleaning-and-organizing-data"><span class="header-section-number">2</span> Cleaning and Organizing Data</a>
  <ul class="collapse">
  <li><a href="#importation-and-cleaning---n₂o-nitrous-oxide" id="toc-importation-and-cleaning---n₂o-nitrous-oxide" class="nav-link" data-scroll-target="#importation-and-cleaning---n₂o-nitrous-oxide"><span class="header-section-number">2.1</span> Importation and Cleaning - N₂O (Nitrous Oxide)</a></li>
  <li><a href="#importation-and-cleaing---ch4-methane" id="toc-importation-and-cleaing---ch4-methane" class="nav-link" data-scroll-target="#importation-and-cleaing---ch4-methane"><span class="header-section-number">2.2</span> Importation and Cleaing - CH<sub>4</sub> (Methane)</a></li>
  <li><a href="#importation-and-cleaning---sf6-sulfur-hexafluoride" id="toc-importation-and-cleaning---sf6-sulfur-hexafluoride" class="nav-link" data-scroll-target="#importation-and-cleaning---sf6-sulfur-hexafluoride"><span class="header-section-number">2.3</span> Importation and Cleaning - SF<sub>6</sub> (Sulfur Hexafluoride)</a></li>
  <li><a href="#merging-and-organising-greenhouse-gasses-dataframes" id="toc-merging-and-organising-greenhouse-gasses-dataframes" class="nav-link" data-scroll-target="#merging-and-organising-greenhouse-gasses-dataframes"><span class="header-section-number">2.4</span> Merging and Organising Greenhouse Gasses dataframes</a>
  <ul class="collapse">
  <li><a href="#merging-and-organising-co2-with-weather-data" id="toc-merging-and-organising-co2-with-weather-data" class="nav-link" data-scroll-target="#merging-and-organising-co2-with-weather-data"><span class="header-section-number">2.4.1</span> Merging and Organising CO2 with Weather data</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#visualisations" id="toc-visualisations" class="nav-link" data-scroll-target="#visualisations"><span class="header-section-number">3</span> Visualisations</a></li>
  <li><a href="#analysis" id="toc-analysis" class="nav-link" data-scroll-target="#analysis"><span class="header-section-number">4</span> Analysis</a>
  <ul class="collapse">
  <li><a href="#descriptive-analysis" id="toc-descriptive-analysis" class="nav-link" data-scroll-target="#descriptive-analysis"><span class="header-section-number">4.1</span> Descriptive Analysis</a>
  <ul class="collapse">
  <li><a href="#co2-and-greenhouse-gasses" id="toc-co2-and-greenhouse-gasses" class="nav-link" data-scroll-target="#co2-and-greenhouse-gasses"><span class="header-section-number">4.1.1</span> CO<sub>2</sub> and Greenhouse Gasses</a></li>
  <li><a href="#co2-and-weather-variables" id="toc-co2-and-weather-variables" class="nav-link" data-scroll-target="#co2-and-weather-variables"><span class="header-section-number">4.1.2</span> CO<sub>2</sub> and Weather Variables</a></li>
  </ul></li>
  <li><a href="#correlation-analysis" id="toc-correlation-analysis" class="nav-link" data-scroll-target="#correlation-analysis"><span class="header-section-number">4.2</span> Correlation Analysis</a>
  <ul class="collapse">
  <li><a href="#correlation-analysis---co2-and-weather-variables" id="toc-correlation-analysis---co2-and-weather-variables" class="nav-link" data-scroll-target="#correlation-analysis---co2-and-weather-variables"><span class="header-section-number">4.2.1</span> Correlation Analysis - CO<sub>2</sub> and Weather variables</a></li>
  <li><a href="#correlation-analysis---co2-greenhouse-gasses-and-weather-variables" id="toc-correlation-analysis---co2-greenhouse-gasses-and-weather-variables" class="nav-link" data-scroll-target="#correlation-analysis---co2-greenhouse-gasses-and-weather-variables"><span class="header-section-number">4.2.2</span> Correlation Analysis - CO<sub>2</sub>, Greenhouse Gasses and Weather Variables</a></li>
  <li><a href="#rolling-correlations" id="toc-rolling-correlations" class="nav-link" data-scroll-target="#rolling-correlations"><span class="header-section-number">4.2.3</span> Rolling Correlations</a></li>
  <li><a href="#year-in-the-past---analysis" id="toc-year-in-the-past---analysis" class="nav-link" data-scroll-target="#year-in-the-past---analysis"><span class="header-section-number">4.2.4</span> 1 year in the past - analysis</a></li>
  <li><a href="#year-in-the-past---analysis-1" id="toc-year-in-the-past---analysis-1" class="nav-link" data-scroll-target="#year-in-the-past---analysis-1"><span class="header-section-number">4.2.5</span> 5 year in the past - analysis</a></li>
  <li><a href="#year-back-analysis" id="toc-year-back-analysis" class="nav-link" data-scroll-target="#year-back-analysis"><span class="header-section-number">4.2.6</span> 10 year back analysis</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions"><span class="header-section-number">5</span> Conclusions</a>
  <ul class="collapse">
  <li><a href="#conclusions---descriptive-analysis" id="toc-conclusions---descriptive-analysis" class="nav-link" data-scroll-target="#conclusions---descriptive-analysis"><span class="header-section-number">5.1</span> Conclusions - Descriptive Analysis</a>
  <ul class="collapse">
  <li><a href="#co2-and-other-greenhouse-gasses" id="toc-co2-and-other-greenhouse-gasses" class="nav-link" data-scroll-target="#co2-and-other-greenhouse-gasses"><span class="header-section-number">5.1.1</span> CO<sub>2</sub> and other Greenhouse Gasses</a></li>
  <li><a href="#co2-and-weather-data" id="toc-co2-and-weather-data" class="nav-link" data-scroll-target="#co2-and-weather-data"><span class="header-section-number">5.1.2</span> CO<sub>2</sub> and Weather Data</a></li>
  </ul></li>
  <li><a href="#conclusions---correlation-analysis" id="toc-conclusions---correlation-analysis" class="nav-link" data-scroll-target="#conclusions---correlation-analysis"><span class="header-section-number">5.2</span> Conclusions - Correlation Analysis</a>
  <ul class="collapse">
  <li><a href="#analyzing-the-reson-of-pearson-kendall-and-granger" id="toc-analyzing-the-reson-of-pearson-kendall-and-granger" class="nav-link" data-scroll-target="#analyzing-the-reson-of-pearson-kendall-and-granger"><span class="header-section-number">5.2.1</span> Analyzing the reson of Pearson, Kendall and Granger</a></li>
  <li><a href="#analyzing-stationarity-check-augmented-dickey-fuller-test" id="toc-analyzing-stationarity-check-augmented-dickey-fuller-test" class="nav-link" data-scroll-target="#analyzing-stationarity-check-augmented-dickey-fuller-test"><span class="header-section-number">5.2.2</span> Analyzing Stationarity Check (<i>Augmented Dickey-Fuller Test</i>)</a></li>
  <li><a href="#analyzing-granger-causality-p-values-across-1-12-lags" id="toc-analyzing-granger-causality-p-values-across-1-12-lags" class="nav-link" data-scroll-target="#analyzing-granger-causality-p-values-across-1-12-lags"><span class="header-section-number">5.2.3</span> Analyzing Granger Causality (<i>p-values across 1-12 lags</i>)</a></li>
  <li><a href="#key-observations-from-1-year-lagged-correlation-analysis" id="toc-key-observations-from-1-year-lagged-correlation-analysis" class="nav-link" data-scroll-target="#key-observations-from-1-year-lagged-correlation-analysis"><span class="header-section-number">5.2.4</span> Key Observations from 1-Year Lagged Correlation Analysis</a></li>
  <li><a href="#key-observations-from-5-year-lagged-correlation-analysis" id="toc-key-observations-from-5-year-lagged-correlation-analysis" class="nav-link" data-scroll-target="#key-observations-from-5-year-lagged-correlation-analysis"><span class="header-section-number">5.2.5</span> Key Observations from 5-Year Lagged Correlation Analysis</a></li>
  <li><a href="#key-observations-from-10-year-lagged-correlation-analysis" id="toc-key-observations-from-10-year-lagged-correlation-analysis" class="nav-link" data-scroll-target="#key-observations-from-10-year-lagged-correlation-analysis"><span class="header-section-number">5.2.6</span> Key Observations from 10-Year Lagged Correlation Analysis</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#continue-to-prediction-models" id="toc-continue-to-prediction-models" class="nav-link" data-scroll-target="#continue-to-prediction-models"><span class="header-section-number">6</span> Continue to Prediction Models 🔗</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Mauna Loa CO2 Analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Ekaterina Cvetkova </p>
             <p>Nikola Kostadinov </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 7, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>The <strong>quantity of CO₂</strong> is determined and described by the chemical term “mole fraction”, defined as the number of carbon dioxide molecules in a given number of molecules of air, after removal of water vapor. For example, 413 parts per million of CO2 (abbreviated as ppm) means that in every million molecules of (dry) air there are on average 413 CO₂ molecules.</p>
<p>In simple terms, <strong>atmospheric CO₂ concentration (in ppm) is the fraction of carbon-dioxide molecules in dry air - one part CO₂ for every one million total air molecules.</strong></p>
<p>The <u>Global Monitoring Laboratory (<strong>GML</strong>)</u> of the National Oceanic and Atmospheric Administration conducts research on: - Greenhouse Gases and Carbon Cycle Feedbacks - Changes in Surface Radiation, Clouds, and Aerosols - Recovery of Stratospheric Ozone</p>
<p>All data regarding the Carbon Cycle Greenhouse gasses is taken directly from the Global Monitoring Laboratory, specifically from the Mauna Loa Observatory, Hawaii. Subsequently, all data is of the same type - <u>in situ samples taken on a daily/weekly basis</u></p>
<p>The weather data used has been acquired through the Open-Meteo open-source weather API, at the suitable coordinates and chosen time range.</p>
<p>This research is conducted in order to determine which factors have an effect on CO₂ levels in the environment, as well as assess which ones have the most prominent influence.</p>
<section id="importing-libraries" class="level4" data-number="1.0.0.1">
<h4 data-number="1.0.0.1" class="anchored" data-anchor-id="importing-libraries"><span class="header-section-number">1.0.0.1</span> Importing Libraries</h4>
<div id="41fabb3a" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> zscore</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> helpers.helpers <span class="im">import</span> (add_missing_one_year, add_missing_ten_years, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                     coerce_into_full_datetime, create_heatmaps, </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                     plot_column, plot_entire_df, plot_increase_five_years,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                     summary_stats, plot_rolling_correlations, interpret_p_value,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                     plot_lagged_correlations)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> helpers.helpers <span class="im">import</span> (WeatherPairPlotter, GasDistributionVisualizer)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tsa.stattools <span class="im">import</span> adfuller, grangercausalitytests</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="importation-of-dataset---co₂-carbon-dioxide" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="importation-of-dataset---co₂-carbon-dioxide"><span class="header-section-number">1.1</span> Importation of Dataset - CO₂ (Carbon Dioxide)</h2>
<div id="391e9976" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df_station_co2 <span class="op">=</span> pd.read_csv(<span class="st">"./data/co2_weekly_mlo.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df_station_co2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">decimal</th>
<th data-quarto-table-cell-role="th">median_CO2</th>
<th data-quarto-table-cell-role="th">ndays</th>
<th data-quarto-table-cell-role="th">1 year ago</th>
<th data-quarto-table-cell-role="th">10 years ago</th>
<th data-quarto-table-cell-role="th">increase since 1800</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1974</td>
<td>5</td>
<td>19</td>
<td>1974.3795</td>
<td>333.37</td>
<td>5</td>
<td>-999.99</td>
<td>-999.99</td>
<td>50.40</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1974</td>
<td>5</td>
<td>26</td>
<td>1974.3986</td>
<td>332.95</td>
<td>6</td>
<td>-999.99</td>
<td>-999.99</td>
<td>50.06</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1974</td>
<td>6</td>
<td>2</td>
<td>1974.4178</td>
<td>332.35</td>
<td>5</td>
<td>-999.99</td>
<td>-999.99</td>
<td>49.60</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1974</td>
<td>6</td>
<td>9</td>
<td>1974.4370</td>
<td>332.20</td>
<td>7</td>
<td>-999.99</td>
<td>-999.99</td>
<td>49.65</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1974</td>
<td>6</td>
<td>16</td>
<td>1974.4562</td>
<td>332.37</td>
<td>7</td>
<td>-999.99</td>
<td>-999.99</td>
<td>50.06</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2662</td>
<td>2025</td>
<td>5</td>
<td>25</td>
<td>2025.3959</td>
<td>430.18</td>
<td>5</td>
<td>426.80</td>
<td>403.98</td>
<td>146.94</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2663</td>
<td>2025</td>
<td>6</td>
<td>1</td>
<td>2025.4151</td>
<td>429.96</td>
<td>7</td>
<td>427.20</td>
<td>403.37</td>
<td>146.91</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2664</td>
<td>2025</td>
<td>6</td>
<td>8</td>
<td>2025.4342</td>
<td>429.93</td>
<td>7</td>
<td>427.25</td>
<td>403.36</td>
<td>147.16</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2665</td>
<td>2025</td>
<td>6</td>
<td>15</td>
<td>2025.4534</td>
<td>429.39</td>
<td>6</td>
<td>426.85</td>
<td>402.48</td>
<td>146.99</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2666</td>
<td>2025</td>
<td>6</td>
<td>22</td>
<td>2025.4726</td>
<td>429.48</td>
<td>6</td>
<td>426.94</td>
<td>402.81</td>
<td>147.51</td>
</tr>
</tbody>
</table>

<p>2667 rows × 9 columns</p>
</div>
</div>
</div>
<p>The initial dataset holds information regarding the CO₂ levels ranging from the year 1974, up to 2025, as well as data on the levels of increase and fequency of measurements. However, the data is severely disorganised and needs cleaing.</p>
</section>
</section>
<section id="cleaning-and-organizing-data" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Cleaning and Organizing Data</h1>
<p>Checking for invalid data:</p>
<div id="85d7f3a7" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>invalid_average <span class="op">=</span> (df_station_co2[<span class="st">'median_CO2'</span>] <span class="op">==</span> <span class="op">-</span><span class="fl">999.99</span>).<span class="bu">sum</span>()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>invalid_1year <span class="op">=</span> (df_station_co2[<span class="st">'1 year ago'</span>] <span class="op">==</span> <span class="op">-</span><span class="fl">999.99</span>).<span class="bu">sum</span>()</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>invalid_10years <span class="op">=</span> (df_station_co2[<span class="st">'10 years ago'</span>] <span class="op">==</span> <span class="op">-</span><span class="fl">999.99</span>).<span class="bu">sum</span>()</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(invalid_average)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(invalid_1year)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(invalid_10years)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>18
70
540</code></pre>
</div>
</div>
<p>The information from the other columns can be used to create a valid datetime format.</p>
<p>The ‘decimal’ column along with the ‘day’ and ‘month’ columns can be used to adjust the datetime index accordingly</p>
<div id="27235ef3" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df_station_co2[<span class="st">'year'</span>] <span class="op">=</span> df_station_co2[<span class="st">'year'</span>].astype(<span class="bu">str</span>).<span class="bu">str</span>.strip()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> df_station_co2[<span class="st">'year'</span>] <span class="op">==</span> <span class="st">'year'</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>df_station_co2.loc[mask, <span class="st">'year'</span>] <span class="op">=</span> df_station_co2.loc[mask, <span class="st">'decimal'</span>].fillna(<span class="dv">0</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">int</span>(<span class="bu">float</span>(x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="45ec8544" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df_station_co2.drop(columns <span class="op">=</span> [<span class="st">'decimal'</span>], inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>df_station_co2 <span class="op">=</span> coerce_into_full_datetime(df_station_co2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="7ce9681c" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df_station_co2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">median_CO2</th>
<th data-quarto-table-cell-role="th">ndays</th>
<th data-quarto-table-cell-role="th">1 year ago</th>
<th data-quarto-table-cell-role="th">10 years ago</th>
<th data-quarto-table-cell-role="th">increase since 1800</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">datetime</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1974-05-19</td>
<td>333.37</td>
<td>5</td>
<td>-999.99</td>
<td>-999.99</td>
<td>50.40</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1974-05-26</td>
<td>332.95</td>
<td>6</td>
<td>-999.99</td>
<td>-999.99</td>
<td>50.06</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1974-06-02</td>
<td>332.35</td>
<td>5</td>
<td>-999.99</td>
<td>-999.99</td>
<td>49.60</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1974-06-09</td>
<td>332.20</td>
<td>7</td>
<td>-999.99</td>
<td>-999.99</td>
<td>49.65</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1974-06-16</td>
<td>332.37</td>
<td>7</td>
<td>-999.99</td>
<td>-999.99</td>
<td>50.06</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2025-05-25</td>
<td>430.18</td>
<td>5</td>
<td>426.80</td>
<td>403.98</td>
<td>146.94</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2025-06-01</td>
<td>429.96</td>
<td>7</td>
<td>427.20</td>
<td>403.37</td>
<td>146.91</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2025-06-08</td>
<td>429.93</td>
<td>7</td>
<td>427.25</td>
<td>403.36</td>
<td>147.16</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2025-06-15</td>
<td>429.39</td>
<td>6</td>
<td>426.85</td>
<td>402.48</td>
<td>146.99</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2025-06-22</td>
<td>429.48</td>
<td>6</td>
<td>426.94</td>
<td>402.81</td>
<td>147.51</td>
</tr>
</tbody>
</table>

<p>2667 rows × 5 columns</p>
</div>
</div>
</div>
<p>The data from the ‘<code>1 year ago</code>’ and ‘<code>10 years ago</code>’ columns is used to include and adjust missing datetimes, thus giving a richer dataframe which would allow us to capture the trend effectively.</p>
<div id="245f6541" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df_station_co2 <span class="op">=</span> add_missing_ten_years(df_station_co2) <span class="co"># using the function to create new rows using the '10 year ago' column</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df_station_co2 <span class="op">=</span> add_missing_one_year(df_station_co2) <span class="co"># using the function to create new rows using the '1 year ago' column</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>df_station_co2.drop(df_station_co2[df_station_co2[<span class="st">'median_CO2'</span>] <span class="op">==</span> <span class="op">-</span><span class="fl">999.99</span>].index, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="282437d9" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df_station_co2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">median_CO2</th>
<th data-quarto-table-cell-role="th">ndays</th>
<th data-quarto-table-cell-role="th">1 year ago</th>
<th data-quarto-table-cell-role="th">10 years ago</th>
<th data-quarto-table-cell-role="th">increase since 1800</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1974-05-19</td>
<td>333.37</td>
<td>5.0</td>
<td>-999.99</td>
<td>-999.99</td>
<td>50.40</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1974-05-25</td>
<td>332.95</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1974-05-26</td>
<td>332.95</td>
<td>6.0</td>
<td>-999.99</td>
<td>-999.99</td>
<td>50.06</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1974-06-01</td>
<td>332.44</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1974-06-02</td>
<td>332.35</td>
<td>5.0</td>
<td>-999.99</td>
<td>-999.99</td>
<td>49.60</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2025-05-25</td>
<td>430.18</td>
<td>5.0</td>
<td>426.80</td>
<td>403.98</td>
<td>146.94</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2025-06-01</td>
<td>429.96</td>
<td>7.0</td>
<td>427.20</td>
<td>403.37</td>
<td>146.91</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2025-06-08</td>
<td>429.93</td>
<td>7.0</td>
<td>427.25</td>
<td>403.36</td>
<td>147.16</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2025-06-15</td>
<td>429.39</td>
<td>6.0</td>
<td>426.85</td>
<td>402.48</td>
<td>146.99</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2025-06-22</td>
<td>429.48</td>
<td>6.0</td>
<td>426.94</td>
<td>402.81</td>
<td>147.51</td>
</tr>
</tbody>
</table>

<p>5246 rows × 5 columns</p>
</div>
</div>
</div>
<section id="importation-and-cleaning---n₂o-nitrous-oxide" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="importation-and-cleaning---n₂o-nitrous-oxide"><span class="header-section-number">2.1</span> Importation and Cleaning - N₂O (Nitrous Oxide)</h2>
<div id="8b58399c" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df_N2O <span class="op">=</span> pd.read_csv(<span class="st">'./data/n2o_daily_mlo.csv'</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>new_column_names <span class="op">=</span> [<span class="st">'year'</span>, <span class="st">'month'</span>, <span class="st">'day'</span>, <span class="st">'median_N2O'</span>, <span class="st">'std._dev.N2O'</span>, <span class="st">'samplesN2O'</span>]</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>df_N2O.columns <span class="op">=</span> new_column_names</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>df_N2O.drop(columns<span class="op">=</span>[<span class="st">"std._dev.N2O"</span>, <span class="st">"samplesN2O"</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>df_N2O</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">median_N2O</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1998</td>
<td>11</td>
<td>28</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1998</td>
<td>11</td>
<td>29</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1998</td>
<td>11</td>
<td>30</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1998</td>
<td>12</td>
<td>1</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1998</td>
<td>12</td>
<td>2</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8760</td>
<td>2022</td>
<td>11</td>
<td>23</td>
<td>337.97</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8761</td>
<td>2022</td>
<td>11</td>
<td>24</td>
<td>337.61</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8762</td>
<td>2022</td>
<td>11</td>
<td>25</td>
<td>337.51</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8763</td>
<td>2022</td>
<td>11</td>
<td>26</td>
<td>337.02</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8764</td>
<td>2022</td>
<td>11</td>
<td>27</td>
<td>337.51</td>
</tr>
</tbody>
</table>

<p>8765 rows × 4 columns</p>
</div>
</div>
</div>
<p>The dataset contains disorganised information on the levels of N₂O, ranging from 1998 to 2022.</p>
<div id="94e3ec85" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df_N2O <span class="op">=</span> coerce_into_full_datetime(df_N2O)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>df_N2O</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">median_N2O</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">datetime</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1998-11-28</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1998-11-29</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1998-11-30</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1998-12-01</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1998-12-02</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022-11-23</td>
<td>337.97</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2022-11-24</td>
<td>337.61</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022-11-25</td>
<td>337.51</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2022-11-26</td>
<td>337.02</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022-11-27</td>
<td>337.51</td>
</tr>
</tbody>
</table>

<p>8765 rows × 1 columns</p>
</div>
</div>
</div>
<div id="4660727d" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>invalid_median <span class="op">=</span> (df_N2O[<span class="st">'median_N2O'</span>].isna()).<span class="bu">sum</span>()</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(invalid_median)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>974</code></pre>
</div>
</div>
<div id="ffe6106e" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df_N2O.interpolate(method<span class="op">=</span><span class="st">'time'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>df_N2O.fillna(method<span class="op">=</span><span class="st">'ffill'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>df_N2O.fillna(method<span class="op">=</span><span class="st">'bfill'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Removing outliers</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>z_scores <span class="op">=</span> np.<span class="bu">abs</span>(zscore(df_N2O[<span class="st">'median_N2O'</span>]))</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>df_N2O <span class="op">=</span> df_N2O[z_scores <span class="op">&lt;</span> <span class="dv">3</span>]</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>df_N2O</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">median_N2O</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">datetime</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1998-11-28</td>
<td>315.59</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1998-11-29</td>
<td>315.59</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1998-11-30</td>
<td>315.59</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1998-12-01</td>
<td>315.59</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1998-12-02</td>
<td>315.59</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022-11-23</td>
<td>337.97</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2022-11-24</td>
<td>337.61</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022-11-25</td>
<td>337.51</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2022-11-26</td>
<td>337.02</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022-11-27</td>
<td>337.51</td>
</tr>
</tbody>
</table>

<p>8765 rows × 1 columns</p>
</div>
</div>
</div>
<p>Different types of interpolation have provided the same results regarding the missing values, however the number of rows affected is relatively small in comparison to the entire dataset. Since the dataset is smaller by itself, regular interpolation and filling is used in order to avoid unnecessary loss of data.</p>
<div id="87c4752c" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>invalid_median <span class="op">=</span> (df_N2O[<span class="st">'median_N2O'</span>].isna()).<span class="bu">sum</span>()</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(invalid_median)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0</code></pre>
</div>
</div>
</section>
<section id="importation-and-cleaing---ch4-methane" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="importation-and-cleaing---ch4-methane"><span class="header-section-number">2.2</span> Importation and Cleaing - CH<sub>4</sub> (Methane)</h2>
<div id="41fece50" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df_CH4 <span class="op">=</span> pd.read_csv(<span class="st">"./data/ch4_daily_mlo.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="0d7b3455" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>new_column_names <span class="op">=</span> [</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"site_code"</span>, <span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>, <span class="st">"hour"</span>, <span class="st">"minute"</span>, <span class="st">"second"</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"datetime"</span>, <span class="st">"time_decimal"</span>, <span class="st">"midpoint_time"</span>, <span class="st">"median_CH4"</span>, <span class="st">"value_std_dev_CH4"</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"nvalue_CH4"</span>, <span class="st">"latitude"</span>, <span class="st">"longitude"</span>, <span class="st">"altitude"</span>, <span class="st">"elevation"</span>, <span class="st">"intake_height"</span>, <span class="st">"qcflag"</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>df_CH4.columns <span class="op">=</span> new_column_names</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>df_CH4.drop(</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>[<span class="st">"site_code"</span>, <span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>, <span class="st">"hour"</span>, <span class="st">"minute"</span>, <span class="st">"second"</span>, <span class="st">"time_decimal"</span>,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>             <span class="st">"midpoint_time"</span>, <span class="st">"latitude"</span>, <span class="st">"longitude"</span>, <span class="st">"altitude"</span>, <span class="st">"elevation"</span>, <span class="st">"intake_height"</span>, <span class="st">"qcflag"</span>],</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    inplace<span class="op">=</span><span class="va">True</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>df_CH4[<span class="st">"datetime"</span>] <span class="op">=</span> pd.to_datetime(df_CH4[<span class="st">"datetime"</span>]).dt.date</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>df_CH4.set_index(<span class="st">"datetime"</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>df_CH4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">median_CH4</th>
<th data-quarto-table-cell-role="th">value_std_dev_CH4</th>
<th data-quarto-table-cell-role="th">nvalue_CH4</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">datetime</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1987-01-02</td>
<td>-999.99</td>
<td>-99.99</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1987-01-03</td>
<td>-999.99</td>
<td>-99.99</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1987-01-04</td>
<td>-999.99</td>
<td>-99.99</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1987-01-05</td>
<td>-999.99</td>
<td>-99.99</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1987-01-06</td>
<td>-999.99</td>
<td>-99.99</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2024-04-26</td>
<td>1977.78</td>
<td>0.85</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2024-04-27</td>
<td>1969.78</td>
<td>2.95</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2024-04-28</td>
<td>1955.87</td>
<td>7.38</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2024-04-29</td>
<td>1924.00</td>
<td>0.84</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2024-04-30</td>
<td>1924.86</td>
<td>0.50</td>
<td>7</td>
</tr>
</tbody>
</table>

<p>13634 rows × 3 columns</p>
</div>
</div>
</div>
<p>The dataset contains disorganised data on CH<sub>4</sub> levels ranging from 1987 to 2024.</p>
<div id="132d7cde" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>invalid_CH4 <span class="op">=</span> (df_CH4[<span class="st">'median_CH4'</span>] <span class="op">==</span> <span class="op">-</span><span class="fl">999.99</span>).<span class="bu">sum</span>()</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>invalid_CH4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>906</code></pre>
</div>
</div>
<p>Since the invalid rows in this dataset are of a miniscule amount in comparison to the size of the whole data, completely removing them does no harm.</p>
<div id="3fd431cd" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df_CH4 <span class="op">=</span> df_CH4.loc[df_CH4[<span class="st">"median_CH4"</span>] <span class="op">!=</span> <span class="op">-</span><span class="fl">999.99</span>]</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Removing outliers</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>z_scores <span class="op">=</span> np.<span class="bu">abs</span>(zscore(df_CH4[<span class="st">'median_CH4'</span>]))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>df_CH4 <span class="op">=</span> df_CH4[z_scores <span class="op">&lt;</span> <span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="59ca4390" class="cell" data-execution_count="18">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>invalid_CH4 <span class="op">=</span> (df_CH4[<span class="st">'median_CH4'</span>] <span class="op">==</span> <span class="op">-</span><span class="fl">999.99</span>).<span class="bu">sum</span>()</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>invalid_CH4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>0</code></pre>
</div>
</div>
</section>
<section id="importation-and-cleaning---sf6-sulfur-hexafluoride" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="importation-and-cleaning---sf6-sulfur-hexafluoride"><span class="header-section-number">2.3</span> Importation and Cleaning - SF<sub>6</sub> (Sulfur Hexafluoride)</h2>
<div id="753df4b3" class="cell" data-execution_count="19">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df_SF6 <span class="op">=</span> pd.read_csv(<span class="st">"./data/sf6_daily_mlo.csv"</span>, skiprows<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>new_column_names <span class="op">=</span> [<span class="st">'year'</span>, <span class="st">'month'</span>, <span class="st">'day'</span>, <span class="st">'median_SF6'</span>, <span class="st">'std._dev.SF6'</span>, <span class="st">'samplesSF6'</span>]</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>df_SF6.columns <span class="op">=</span> new_column_names</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>df_SF6.drop(columns<span class="op">=</span>[<span class="st">"std._dev.SF6"</span>, <span class="st">"samplesSF6"</span>], inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="54cb077d" class="cell" data-execution_count="20">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>df_SF6[<span class="st">'year'</span>] <span class="op">=</span> df_SF6[<span class="st">'year'</span>].astype(<span class="bu">str</span>).<span class="bu">str</span>.strip()</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> df_SF6[<span class="st">'year'</span>] <span class="op">==</span> <span class="st">'year'</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>df_SF6 <span class="op">=</span> coerce_into_full_datetime(df_SF6) <span class="co"># using the `year`, `month` and `day` columns</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>df_SF6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">median_SF6</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">datetime</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1998-11-29</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1998-11-30</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1998-12-01</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1998-12-02</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1998-12-03</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022-11-23</td>
<td>11.594</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2022-11-24</td>
<td>11.518</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022-11-25</td>
<td>11.455</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2022-11-26</td>
<td>11.394</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022-11-27</td>
<td>11.405</td>
</tr>
</tbody>
</table>

<p>8764 rows × 1 columns</p>
</div>
</div>
</div>
<p>The dataset contains disorganised data on SF<sub>6</sub> levels ranging from 1998 to 2022</p>
<div id="7b2bae5f" class="cell" data-execution_count="21">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>invalid_median <span class="op">=</span> (df_SF6[<span class="st">'median_SF6'</span>].isna()).<span class="bu">sum</span>()</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(invalid_median)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>1069</code></pre>
</div>
</div>
<div id="9fa63524" class="cell" data-execution_count="22">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df_SF6.interpolate(method<span class="op">=</span><span class="st">'time'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>df_SF6.fillna(method<span class="op">=</span><span class="st">'ffill'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>df_SF6.fillna(method<span class="op">=</span><span class="st">'bfill'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Removing outliers</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>z_scores <span class="op">=</span> np.<span class="bu">abs</span>(zscore(df_SF6[<span class="st">'median_SF6'</span>]))</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>df_SF6 <span class="op">=</span> df_SF6[z_scores <span class="op">&lt;</span> <span class="dv">3</span>]</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>df_SF6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">median_SF6</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">datetime</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1998-11-29</td>
<td>4.351</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1998-11-30</td>
<td>4.351</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1998-12-01</td>
<td>4.351</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1998-12-02</td>
<td>4.351</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1998-12-03</td>
<td>4.351</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022-11-23</td>
<td>11.594</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2022-11-24</td>
<td>11.518</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022-11-25</td>
<td>11.455</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2022-11-26</td>
<td>11.394</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022-11-27</td>
<td>11.405</td>
</tr>
</tbody>
</table>

<p>8764 rows × 1 columns</p>
</div>
</div>
</div>
<p>The same interpolation method is used as before, for the same reasons.</p>
<div id="87b680be" class="cell" data-execution_count="23">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>invalid_median <span class="op">=</span> (df_SF6[<span class="st">'median_SF6'</span>].isna()).<span class="bu">sum</span>()</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(invalid_median)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0</code></pre>
</div>
</div>
</section>
<section id="merging-and-organising-greenhouse-gasses-dataframes" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="merging-and-organising-greenhouse-gasses-dataframes"><span class="header-section-number">2.4</span> Merging and Organising Greenhouse Gasses dataframes</h2>
<div id="6f375e40" class="cell" data-execution_count="23">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>dfs <span class="op">=</span> [df.copy() <span class="cf">for</span> df <span class="kw">in</span> [df_station_co2, df_N2O, df_CH4, df_SF6]]</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dfs)):</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    dfs[i].index <span class="op">=</span> pd.to_datetime(dfs[i].index)  <span class="co"># Converting index to proper datetime64[ns]</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>start_date <span class="op">=</span> df_station_co2.index.<span class="bu">min</span>()  <span class="co"># Get the earliest date from df_CO2_meteo</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>dfs <span class="op">=</span> [df[df.index <span class="op">&gt;=</span> start_date] <span class="cf">for</span> df <span class="kw">in</span> dfs]</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>df_combined_gasses <span class="op">=</span> pd.concat(</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>        dfs[<span class="dv">0</span>][[<span class="st">"median_CO2"</span>]],</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>        dfs[<span class="dv">1</span>][[<span class="st">"median_N2O"</span>]],</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>        dfs[<span class="dv">2</span>][[<span class="st">"median_CH4"</span>]],</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>        dfs[<span class="dv">3</span>][[<span class="st">"median_SF6"</span>]],</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    axis<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    join<span class="op">=</span><span class="st">"inner"</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="71db9f14" class="cell" data-execution_count="24">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df_combined_gasses</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">median_CO2</th>
<th data-quarto-table-cell-role="th">median_N2O</th>
<th data-quarto-table-cell-role="th">median_CH4</th>
<th data-quarto-table-cell-role="th">median_SF6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1998-11-29</td>
<td>366.74</td>
<td>315.59</td>
<td>1803.06</td>
<td>4.351</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1998-12-12</td>
<td>367.20</td>
<td>315.59</td>
<td>1799.96</td>
<td>4.351</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1998-12-13</td>
<td>367.32</td>
<td>315.59</td>
<td>1800.91</td>
<td>4.351</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1998-12-19</td>
<td>367.48</td>
<td>315.59</td>
<td>1799.07</td>
<td>4.351</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1998-12-20</td>
<td>367.44</td>
<td>315.59</td>
<td>1807.50</td>
<td>4.351</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022-11-13</td>
<td>417.25</td>
<td>337.65</td>
<td>1951.90</td>
<td>11.413</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2022-11-19</td>
<td>418.38</td>
<td>337.01</td>
<td>1948.15</td>
<td>11.305</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022-11-20</td>
<td>418.48</td>
<td>337.93</td>
<td>1958.26</td>
<td>11.425</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2022-11-26</td>
<td>417.81</td>
<td>337.02</td>
<td>1954.00</td>
<td>11.394</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022-11-27</td>
<td>417.69</td>
<td>337.51</td>
<td>1952.95</td>
<td>11.405</td>
</tr>
</tbody>
</table>

<p>2408 rows × 4 columns</p>
</div>
</div>
</div>
<section id="merging-and-organising-co2-with-weather-data" class="level3" data-number="2.4.1">
<h3 data-number="2.4.1" class="anchored" data-anchor-id="merging-and-organising-co2-with-weather-data"><span class="header-section-number">2.4.1</span> Merging and Organising CO2 with Weather data</h3>
<div id="da1e0e21" class="cell" data-execution_count="25">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>df_weather <span class="op">=</span> pd.read_csv(<span class="st">'./data/open_meteo_weather_API.csv'</span>, skiprows<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>df_weather.index <span class="op">=</span> pd.to_datetime(df_weather.index).strftime(<span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S'</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>df_weather.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>df_weather.set_index(<span class="st">'time'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>df_weather.drop(columns <span class="op">=</span> <span class="st">'index'</span>, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>df_weather.index <span class="op">=</span> pd.to_datetime(df_weather.index)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>df_weather <span class="op">=</span> df_weather.resample(<span class="st">'D'</span>).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="a5e28004" class="cell" data-execution_count="26">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>df_weather</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">temperature_2m (°C)</th>
<th data-quarto-table-cell-role="th">relative_humidity_2m (%)</th>
<th data-quarto-table-cell-role="th">dew_point_2m (°C)</th>
<th data-quarto-table-cell-role="th">precipitation (mm)</th>
<th data-quarto-table-cell-role="th">pressure_msl (hPa)</th>
<th data-quarto-table-cell-role="th">et0_fao_evapotranspiration (mm)</th>
<th data-quarto-table-cell-role="th">wind_speed_10m (km/h)</th>
<th data-quarto-table-cell-role="th">soil_temperature_0_to_7cm (°C)</th>
<th data-quarto-table-cell-role="th">surface_pressure (hPa)</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">time</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1974-05-01</td>
<td>26.391667</td>
<td>78.666667</td>
<td>22.375000</td>
<td>0.000000</td>
<td>1013.758333</td>
<td>0.227917</td>
<td>32.920833</td>
<td>26.700000</td>
<td>1013.758333</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1974-05-02</td>
<td>26.612500</td>
<td>78.500000</td>
<td>22.570833</td>
<td>0.000000</td>
<td>1014.570833</td>
<td>0.227500</td>
<td>28.279167</td>
<td>26.933333</td>
<td>1014.570833</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1974-05-03</td>
<td>26.275000</td>
<td>78.625000</td>
<td>22.258333</td>
<td>0.020833</td>
<td>1014.241667</td>
<td>0.226250</td>
<td>22.037500</td>
<td>27.066667</td>
<td>1014.241667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1974-05-04</td>
<td>26.266667</td>
<td>82.041667</td>
<td>22.929167</td>
<td>0.041667</td>
<td>1013.062500</td>
<td>0.197500</td>
<td>22.354167</td>
<td>27.300000</td>
<td>1013.062500</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1974-05-05</td>
<td>26.454167</td>
<td>84.375000</td>
<td>23.629167</td>
<td>0.050000</td>
<td>1014.145833</td>
<td>0.197917</td>
<td>25.895833</td>
<td>27.466667</td>
<td>1014.145833</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2025-06-21</td>
<td>26.516667</td>
<td>82.750000</td>
<td>23.304167</td>
<td>0.758333</td>
<td>1014.062500</td>
<td>0.123750</td>
<td>21.395833</td>
<td>29.095833</td>
<td>1014.062500</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2025-06-22</td>
<td>27.600000</td>
<td>77.791667</td>
<td>23.320833</td>
<td>0.241667</td>
<td>1013.891667</td>
<td>0.187083</td>
<td>21.125000</td>
<td>29.000000</td>
<td>1013.891667</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2025-06-23</td>
<td>28.125000</td>
<td>76.458333</td>
<td>23.570833</td>
<td>0.054167</td>
<td>1013.858333</td>
<td>0.243333</td>
<td>24.237500</td>
<td>29.020833</td>
<td>1013.858333</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2025-06-24</td>
<td>28.554167</td>
<td>75.125000</td>
<td>23.708333</td>
<td>0.020833</td>
<td>1014.670833</td>
<td>0.261667</td>
<td>25.520833</td>
<td>29.037500</td>
<td>1014.670833</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2025-06-25</td>
<td>28.550000</td>
<td>71.250000</td>
<td>22.816667</td>
<td>0.000000</td>
<td>1015.145833</td>
<td>0.270000</td>
<td>22.083333</td>
<td>29.020833</td>
<td>1015.145833</td>
</tr>
</tbody>
</table>

<p>18684 rows × 9 columns</p>
</div>
</div>
</div>
<div id="c4feb881" class="cell" data-execution_count="27">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating df on dates when station data and Open Meteo data overlap</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>common_dates <span class="op">=</span> df_weather.index.intersection(df_station_co2.index)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>df_weather <span class="op">=</span> df_weather.loc[common_dates]</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Merging</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>df_station_column <span class="op">=</span> df_station_co2[[<span class="st">'median_CO2'</span>]]</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>df_CO2_meteo <span class="op">=</span> df_weather.join(df_station_column, how<span class="op">=</span><span class="st">'inner'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="13c8eb73" class="cell" data-execution_count="28">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>df_CO2_meteo.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>Index(['temperature_2m (°C)', 'relative_humidity_2m (%)', 'dew_point_2m (°C)',
       'precipitation (mm)', 'pressure_msl (hPa)',
       'et0_fao_evapotranspiration (mm)', 'wind_speed_10m (km/h)',
       'soil_temperature_0_to_7cm (°C)', 'surface_pressure (hPa)',
       'median_CO2'],
      dtype='object')</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="visualisations" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Visualisations</h1>
<div id="85cfadcf" class="cell" data-execution_count="29">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>plot_column(df_combined_gasses, <span class="st">'median_CO2'</span>, <span class="st">'red'</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>plot_column(df_combined_gasses, <span class="st">'median_N2O'</span>, <span class="st">'blue'</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>plot_column(df_combined_gasses, <span class="st">'median_CH4'</span>, <span class="st">'green'</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>plot_column(df_combined_gasses, <span class="st">'median_SF6'</span>, <span class="st">'magenta'</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>plt.tight_layout</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preprocessing_files/figure-html/cell-31-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preprocessing_files/figure-html/cell-31-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preprocessing_files/figure-html/cell-31-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preprocessing_files/figure-html/cell-31-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="7f1c4504" class="cell" data-execution_count="30">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>plot_entire_df(df_CO2_meteo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preprocessing_files/figure-html/cell-32-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The visualisations, in both datasets clearly depicts the seasonal trends.</p>
<p>Outliers in the weather dataset were not removed, as there are numerous natural reasons for sudden spikes or drops in most variables.</p>
</section>
<section id="analysis" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Analysis</h1>
<section id="descriptive-analysis" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="descriptive-analysis"><span class="header-section-number">4.1</span> Descriptive Analysis</h2>
<section id="co2-and-greenhouse-gasses" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="co2-and-greenhouse-gasses"><span class="header-section-number">4.1.1</span> CO<sub>2</sub> and Greenhouse Gasses</h3>
<div id="9ea8d4fa" class="cell" data-execution_count="31">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>visualizer <span class="op">=</span> GasDistributionVisualizer(df_combined_gasses, summary_stats(df_combined_gasses))</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>visualizer.visualize()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preprocessing_files/figure-html/cell-33-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="bed24d12" class="cell" data-execution_count="32">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>plot_increase_five_years(df_combined_gasses, <span class="st">"median_CO2"</span>, <span class="st">"CO2"</span>, <span class="st">"darkorange"</span>, <span class="st">'darkred'</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>plot_increase_five_years(df_combined_gasses, <span class="st">"median_N2O"</span>, <span class="st">"N2O"</span>, <span class="st">"lightblue"</span>, <span class="st">"darkblue"</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>plot_increase_five_years(df_combined_gasses, <span class="st">"median_CH4"</span>, <span class="st">"CH4"</span>, <span class="st">"yellow"</span>, <span class="st">"green"</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>plot_increase_five_years(df_combined_gasses, <span class="st">"median_SF6"</span>, <span class="st">"SF6"</span>, <span class="st">"pink"</span>, <span class="st">"magenta"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preprocessing_files/figure-html/cell-34-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preprocessing_files/figure-html/cell-34-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preprocessing_files/figure-html/cell-34-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preprocessing_files/figure-html/cell-34-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The visualisations show clear increase of gas concentration over time.</p>
</section>
<section id="co2-and-weather-variables" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="co2-and-weather-variables"><span class="header-section-number">4.1.2</span> CO<sub>2</sub> and Weather Variables</h3>
<div id="3c0472fd-c4a0-4323-9843-acee45446ebb" class="cell" data-execution_count="33">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>selected_cols <span class="op">=</span> [</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"temperature_2m (°C)"</span>,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"relative_humidity_2m (%)"</span>,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"wind_speed_10m (km/h)"</span>,</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"surface_pressure (hPa)"</span>,</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"median_CO2"</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>plotter <span class="op">=</span> WeatherPairPlotter(</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    df_CO2_meteo,</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    selected_cols,</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pairwise relationships - CO₂ &amp; weather variables"</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>plotter.create_pairplot()</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>plotter.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preprocessing_files/figure-html/cell-35-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="22774d98-9380-46b1-8438-dd29d2c793eb" class="cell" data-execution_count="34">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>summary_stats(df_weather)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="34">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">column</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">median</th>
<th data-quarto-table-cell-role="th">mode</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">var</th>
<th data-quarto-table-cell-role="th">range</th>
<th data-quarto-table-cell-role="th">IQR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>temperature_2m (°C)</td>
<td>26.440551</td>
<td>26.695833</td>
<td>27.170833</td>
<td>1.289433</td>
<td>1.662639</td>
<td>8.154167</td>
<td>1.853125</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>relative_humidity_2m (%)</td>
<td>79.017593</td>
<td>80.500000</td>
<td>82.041667</td>
<td>5.989612</td>
<td>35.875452</td>
<td>39.375000</td>
<td>6.489583</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>dew_point_2m (°C)</td>
<td>22.450477</td>
<td>23.075000</td>
<td>24.079167</td>
<td>2.123801</td>
<td>4.510530</td>
<td>13.150000</td>
<td>2.498958</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>precipitation (mm)</td>
<td>0.122877</td>
<td>0.033333</td>
<td>0.000000</td>
<td>0.273434</td>
<td>0.074766</td>
<td>4.079167</td>
<td>0.112500</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>pressure_msl (hPa)</td>
<td>1013.277113</td>
<td>1013.412500</td>
<td>1013.320833</td>
<td>2.545035</td>
<td>6.477205</td>
<td>29.137500</td>
<td>2.873958</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>et0_fao_evapotranspiration (mm)</td>
<td>0.188450</td>
<td>0.192083</td>
<td>0.175000</td>
<td>0.033404</td>
<td>0.001116</td>
<td>0.217917</td>
<td>0.045000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>wind_speed_10m (km/h)</td>
<td>23.522957</td>
<td>23.489583</td>
<td>22.804167</td>
<td>8.288643</td>
<td>68.701596</td>
<td>61.375000</td>
<td>11.064583</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>soil_temperature_0_to_7cm (°C)</td>
<td>27.951299</td>
<td>28.033333</td>
<td>29.000000</td>
<td>1.268068</td>
<td>1.607996</td>
<td>6.133333</td>
<td>2.100000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>surface_pressure (hPa)</td>
<td>1013.277113</td>
<td>1013.412500</td>
<td>1013.320833</td>
<td>2.545035</td>
<td>6.477205</td>
<td>29.137500</td>
<td>2.873958</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Since CO₂ is the target of interest, plotting all columns would flood the grid, making patterns hard to see.</p>
<p>Temperature, humidity, wind speed and surface pressure are the four classic meteorological drivers most often linked to CO₂ variability, therefore a pairplot provides a clear, representative snapshot without overcrowding the visual.</p>
</section>
</section>
<section id="correlation-analysis" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="correlation-analysis"><span class="header-section-number">4.2</span> Correlation Analysis</h2>
<section id="correlation-analysis---co2-and-weather-variables" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="correlation-analysis---co2-and-weather-variables"><span class="header-section-number">4.2.1</span> Correlation Analysis - CO<sub>2</sub> and Weather variables</h3>
<div id="df35dba8-f47f-4845-9331-1014a4a30044" class="cell" data-execution_count="35">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Computing Kendall's Tau correlation matrix</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>kendall_corr <span class="op">=</span> df_CO2_meteo.corr(method<span class="op">=</span><span class="st">'kendall'</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>create_heatmaps((kendall_corr, <span class="st">"Knedall Correlation Heatmap"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preprocessing_files/figure-html/cell-37-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Surprisingly and unfortunately, there seems to be little to no correlation between the weather data and the average levels of CO2 at this particular location.</p>
<p>However further testing and assessment is needed before drawing final conclusions.</p>
<p>The heatmap shows that <em>surface_pressure</em> and <em>pressure_msi</em> have identical values. To avoid redundancy, <em>surface_pressure</em> was removed.</p>
<div id="d4516818-7f5e-46dd-be7d-90be78ba1015" class="cell" data-execution_count="36">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>df_CO2_meteo.drop([<span class="st">'surface_pressure (hPa)'</span>],axis<span class="op">=</span><span class="dv">1</span>,inplace <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="b2601c85-4645-46b1-96e6-e323c4f99309" class="cell" data-execution_count="37">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>df_CO2_meteo.rename(columns<span class="op">=</span>{<span class="st">'average'</span>: <span class="st">'average_CO2'</span>, <span class="st">'temperature_2m (°C)'</span> : <span class="st">'temperature'</span>, </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'relative_humidity_2m (%)'</span>:<span class="st">'humidity'</span>, <span class="st">'dew_point_2m (°C)'</span> : <span class="st">'dew_point'</span>,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'precipitation (mm)'</span> : <span class="st">'precipitation'</span>, <span class="st">'pressure_msl (hPa)'</span> : <span class="st">'pressure'</span>,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'et0_fao_evapotranspiration (mm)'</span> : <span class="st">'evapotranspiration'</span>, </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'wind_speed_10m (km/h)'</span> : <span class="st">'wind_speed'</span>, <span class="st">'soil_temperature_0_to_7cm (°C)'</span> : <span class="st">'soil_temperature'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="07cd5137-bc92-4548-ab9d-cc88992417cb" class="cell" data-execution_count="38">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>df_CO2_meteo.to_csv(<span class="st">'./data/df_CO2_meteo.csv'</span>, index<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="correlation-analysis---co2-greenhouse-gasses-and-weather-variables" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="correlation-analysis---co2-greenhouse-gasses-and-weather-variables"><span class="header-section-number">4.2.2</span> Correlation Analysis - CO<sub>2</sub>, Greenhouse Gasses and Weather Variables</h3>
<div id="d54b6e5d-bd5a-492a-9349-15062ef2dab4" class="cell" data-execution_count="39">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>df_combined_inner <span class="op">=</span> pd.concat(</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    [df_CO2_meteo[[<span class="st">'temperature'</span>, <span class="st">'humidity'</span>, <span class="st">'dew_point'</span>, <span class="st">'precipitation'</span>, <span class="st">'pressure'</span>,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>             <span class="st">'evapotranspiration'</span>, <span class="st">'wind_speed'</span>, <span class="st">'soil_temperature'</span>]],</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>     df_combined_gasses[[<span class="st">'median_CO2'</span>, <span class="st">'median_N2O'</span>, <span class="st">'median_CH4'</span>, <span class="st">'median_SF6'</span>]]],</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    axis<span class="op">=</span><span class="dv">1</span>, join<span class="op">=</span><span class="st">"inner"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="3629ac46-3835-4a2d-918f-e8a1f109ad96" class="cell" data-execution_count="40">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Computing Pearson correlation matrix</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>pearson_corr <span class="op">=</span> df_combined_inner.corr(method<span class="op">=</span><span class="st">'pearson'</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Computing Kendall's Tau correlation matrix</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>kendall_corr <span class="op">=</span> df_combined_inner.corr(method<span class="op">=</span><span class="st">'kendall'</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>create_heatmaps(</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>                (pearson_corr, <span class="st">"Pearson Correlation Heatmap"</span>),</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>                (kendall_corr, <span class="st">"Kendall Correlation Heatmap"</span>)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preprocessing_files/figure-html/cell-42-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><strong>Pearson’s correlation</strong> measures the linear relationship between variables.</p>
<p>The correlation coefficient ranges from -1 to +1, where -1 indicates a perfect negative linear relationship, +1 indicates a perfect positive linear relationship, and 0 indicates no linear relationship.</p>
<p>However, it has a limitation: it only captures linear relationships and can miss other types of relationships between variables.</p>
<p><strong>Kendall’s Tau</strong> takes a different approach. Instead of measuring linear relationships, it looks at the concordance between variables - essentially, whether they tend to move in the same direction. It’s measuring the tendency of the variables to increase or decrease together, without assuming anything about the shape of that relationship.</p>
<p>In the context of environmental data like CO2 levels, temperature, and other climate variables, Kendall’s Tau might be particularly useful because environmental relationships aren’t always linear, and the data often contains outliers or follows non-normal distributions.</p>
</section>
<section id="rolling-correlations" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="rolling-correlations"><span class="header-section-number">4.2.3</span> Rolling Correlations</h3>
<div id="814d485b-041a-4c32-84e9-eefe739623d1" class="cell" data-execution_count="41">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>plot_rolling_correlations(df_combined_inner)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preprocessing_files/figure-html/cell-43-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preprocessing_files/figure-html/cell-43-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preprocessing_files/figure-html/cell-43-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preprocessing_files/figure-html/cell-43-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preprocessing_files/figure-html/cell-43-output-5.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preprocessing_files/figure-html/cell-43-output-6.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preprocessing_files/figure-html/cell-43-output-7.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preprocessing_files/figure-html/cell-43-output-8.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preprocessing_files/figure-html/cell-43-output-9.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preprocessing_files/figure-html/cell-43-output-10.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preprocessing_files/figure-html/cell-43-output-11.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><strong>Rolling correlations</strong> (also called <em>moving correlations</em>) are a dynamic way to measure how the relationship between two variables changes over time. Unlike a single correlation coefficient that shows one number for an entire dataset, rolling correlations show how the correlation evolves throughout a time series.</p>
<p>Rolling correlations can be used in environmental studies to understand how relationships between variables shift with seasonal or long-term changes.</p>
<div id="7b6be40d-a1a1-4cfa-9d10-7e751dd6d3e4" class="cell" data-execution_count="42">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking for stationarity (Augmented Dickey-Fuller Test)</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> check_stationarity(series, variable_name):</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> adfuller(series.dropna())</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    p_value <span class="op">=</span> result[<span class="dv">1</span>]</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> p_value</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>stationarity_results <span class="op">=</span> {col: check_stationarity(df_combined_inner[col], col) <span class="cf">for</span> col <span class="kw">in</span> df_combined_inner.columns}</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>max_lag <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>granger_results <span class="op">=</span> {}</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Performing Granger Causality tests</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> df_combined_inner.columns:</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> col <span class="op">!=</span> <span class="st">"median_CO2"</span>:</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>        test_result <span class="op">=</span> grangercausalitytests(df_combined_inner[[<span class="st">'median_CO2'</span>, col]].dropna(), max_lag, verbose<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>        granger_results[col] <span class="op">=</span> {lag: test_result[lag][<span class="dv">0</span>][<span class="st">'ssr_ftest'</span>][<span class="dv">1</span>] <span class="cf">for</span> lag <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, max_lag <span class="op">+</span> <span class="dv">1</span>)}</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>stationarity_results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>{'temperature': 8.363219045752621e-22,
 'humidity': 1.2650078417762235e-12,
 'dew_point': 1.1325418875804807e-19,
 'precipitation': 6.54844740791231e-20,
 'pressure': 6.803475148892472e-12,
 'evapotranspiration': 6.662669342414485e-14,
 'wind_speed': 8.122153250418046e-30,
 'soil_temperature': 1.480580933517278e-23,
 'median_CO2': 0.8630583937959493,
 'median_N2O': 0.999004879583799,
 'median_CH4': 0.6729054440779778,
 'median_SF6': 1.0}</code></pre>
</div>
</div>
<p>The <strong>ADF test</strong> checks whether a time series data is stationary, which is crucial for many statistical analyses. A stationary time series has consistent statistical properties over time - its mean and variance don’t change.</p>
<p><strong>Granger Causality tests</strong> explore whether past values of one variable help predict future values of another. It’s testing the <em>“statistical causality”</em> - though it’s important to note that Granger causality doesn’t necessarily mean actual causation.</p>
<div id="16def702-65fb-4714-84b8-9d6244c951a4" class="cell" data-execution_count="43">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting Granger causality test results into a readable dataFrame</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>granger_df <span class="op">=</span> pd.DataFrame.from_dict(</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    {var: [granger_results[var][lag] <span class="cf">for</span> lag <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, max_lag <span class="op">+</span> <span class="dv">1</span>)] <span class="cf">for</span> var <span class="kw">in</span> granger_results.keys()},</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    orient<span class="op">=</span><span class="st">'index'</span>,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>[<span class="ss">f'Lag </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, max_lag <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>granger_df[<span class="st">"Interpretation"</span>] <span class="op">=</span> granger_df.<span class="bu">apply</span>(<span class="kw">lambda</span> row: interpret_p_value(row.values), axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>granger_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="43">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Lag 1</th>
<th data-quarto-table-cell-role="th">Lag 2</th>
<th data-quarto-table-cell-role="th">Lag 3</th>
<th data-quarto-table-cell-role="th">Lag 4</th>
<th data-quarto-table-cell-role="th">Lag 5</th>
<th data-quarto-table-cell-role="th">Lag 6</th>
<th data-quarto-table-cell-role="th">Lag 7</th>
<th data-quarto-table-cell-role="th">Lag 8</th>
<th data-quarto-table-cell-role="th">Lag 9</th>
<th data-quarto-table-cell-role="th">Lag 10</th>
<th data-quarto-table-cell-role="th">Lag 11</th>
<th data-quarto-table-cell-role="th">Lag 12</th>
<th data-quarto-table-cell-role="th">Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">temperature</td>
<td>8.860331e-25</td>
<td>6.125019e-21</td>
<td>9.139548e-26</td>
<td>1.153685e-23</td>
<td>9.072832e-19</td>
<td>3.638934e-17</td>
<td>9.287039e-13</td>
<td>2.513450e-12</td>
<td>6.157650e-10</td>
<td>4.928071e-09</td>
<td>1.107482e-07</td>
<td>2.643238e-07</td>
<td>Strong causality (p &lt; 0.01)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">humidity</td>
<td>5.412154e-12</td>
<td>1.355012e-10</td>
<td>7.679884e-14</td>
<td>2.316054e-14</td>
<td>2.371246e-11</td>
<td>4.718695e-10</td>
<td>4.977062e-07</td>
<td>1.102951e-06</td>
<td>4.651620e-04</td>
<td>1.977284e-03</td>
<td>3.329687e-03</td>
<td>5.198356e-03</td>
<td>Strong causality (p &lt; 0.01)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">dew_point</td>
<td>5.675254e-25</td>
<td>3.372136e-21</td>
<td>6.370466e-26</td>
<td>2.643040e-24</td>
<td>1.005720e-19</td>
<td>3.305932e-18</td>
<td>1.318876e-13</td>
<td>6.190707e-13</td>
<td>4.089969e-09</td>
<td>3.356633e-08</td>
<td>1.146731e-07</td>
<td>2.286169e-07</td>
<td>Strong causality (p &lt; 0.01)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">precipitation</td>
<td>3.335772e-04</td>
<td>4.410408e-03</td>
<td>5.678484e-04</td>
<td>9.592754e-05</td>
<td>7.665915e-03</td>
<td>2.647713e-02</td>
<td>3.181859e-01</td>
<td>4.591433e-01</td>
<td>8.512952e-01</td>
<td>8.234535e-01</td>
<td>3.107554e-01</td>
<td>1.280790e-01</td>
<td>Moderate to low causality (p &lt; 0.05 at some lags)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">pressure</td>
<td>3.974949e-11</td>
<td>7.202753e-09</td>
<td>1.696877e-10</td>
<td>5.812546e-09</td>
<td>1.529336e-06</td>
<td>1.098885e-05</td>
<td>1.494581e-03</td>
<td>3.374869e-03</td>
<td>2.204412e-02</td>
<td>3.237441e-02</td>
<td>9.750331e-03</td>
<td>7.394630e-03</td>
<td>Moderate to low causality (p &lt; 0.05 at some lags)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">evapotranspiration</td>
<td>2.936080e-04</td>
<td>2.139267e-05</td>
<td>2.703366e-07</td>
<td>1.830569e-06</td>
<td>2.238435e-08</td>
<td>5.948315e-10</td>
<td>3.678599e-09</td>
<td>9.330394e-09</td>
<td>1.212121e-08</td>
<td>2.166788e-09</td>
<td>3.846173e-12</td>
<td>7.796286e-13</td>
<td>Strong causality (p &lt; 0.01)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">wind_speed</td>
<td>1.507003e-12</td>
<td>5.085571e-12</td>
<td>5.962854e-14</td>
<td>4.002204e-15</td>
<td>1.325402e-13</td>
<td>1.453057e-12</td>
<td>3.860814e-10</td>
<td>5.798164e-10</td>
<td>1.293346e-08</td>
<td>2.384598e-08</td>
<td>1.391180e-07</td>
<td>6.883282e-08</td>
<td>Strong causality (p &lt; 0.01)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">soil_temperature</td>
<td>4.941134e-32</td>
<td>2.356060e-26</td>
<td>1.323579e-39</td>
<td>2.176442e-37</td>
<td>1.956638e-32</td>
<td>1.315729e-30</td>
<td>6.723724e-24</td>
<td>2.885878e-23</td>
<td>4.764458e-22</td>
<td>6.246227e-21</td>
<td>8.229312e-22</td>
<td>3.508551e-21</td>
<td>Strong causality (p &lt; 0.01)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">median_N2O</td>
<td>8.008445e-05</td>
<td>4.118513e-05</td>
<td>8.078303e-04</td>
<td>6.303455e-04</td>
<td>1.439309e-04</td>
<td>3.025065e-06</td>
<td>1.612906e-08</td>
<td>1.365409e-08</td>
<td>6.937741e-13</td>
<td>4.135353e-14</td>
<td>9.966893e-18</td>
<td>1.458885e-18</td>
<td>Strong causality (p &lt; 0.01)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">median_CH4</td>
<td>6.094348e-06</td>
<td>1.821082e-13</td>
<td>1.783052e-19</td>
<td>2.951395e-22</td>
<td>2.037874e-23</td>
<td>3.249063e-25</td>
<td>1.223335e-22</td>
<td>4.499614e-22</td>
<td>6.773017e-15</td>
<td>8.673936e-14</td>
<td>5.394487e-13</td>
<td>1.508888e-12</td>
<td>Strong causality (p &lt; 0.01)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">median_SF6</td>
<td>8.433207e-04</td>
<td>2.402066e-07</td>
<td>7.523613e-06</td>
<td>7.130874e-08</td>
<td>2.532144e-11</td>
<td>1.648528e-12</td>
<td>6.471290e-15</td>
<td>7.232538e-15</td>
<td>5.658483e-17</td>
<td>3.503844e-18</td>
<td>1.710563e-20</td>
<td>1.563221e-22</td>
<td>Strong causality (p &lt; 0.01)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="year-in-the-past---analysis" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="year-in-the-past---analysis"><span class="header-section-number">4.2.4</span> 1 year in the past - analysis</h3>
<div id="3fdf6c68-25d5-4fc3-9b6f-4e9e17b9e70c" class="cell" data-execution_count="45">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>plot_lagged_correlations(df_combined_inner, <span class="st">'median_CO2'</span>, <span class="dv">365</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preprocessing_files/figure-html/cell-46-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="year-in-the-past---analysis-1" class="level3" data-number="4.2.5">
<h3 data-number="4.2.5" class="anchored" data-anchor-id="year-in-the-past---analysis-1"><span class="header-section-number">4.2.5</span> 5 year in the past - analysis</h3>
<div id="ab8523fc-725a-48ca-85c6-c448f49138bd" class="cell" data-execution_count="46">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>plot_lagged_correlations(df_combined_inner, <span class="st">'median_CO2'</span>, <span class="dv">1825</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preprocessing_files/figure-html/cell-47-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="year-back-analysis" class="level3" data-number="4.2.6">
<h3 data-number="4.2.6" class="anchored" data-anchor-id="year-back-analysis"><span class="header-section-number">4.2.6</span> 10 year back analysis</h3>
<div id="77db0c44-0283-4573-8b50-3c37023ca584" class="cell" data-execution_count="47">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>plot_lagged_correlations(df_combined_inner, <span class="st">'median_CO2'</span>, <span class="dv">3650</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preprocessing_files/figure-html/cell-48-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="b5bf05de-6c0b-43bc-96b0-e0c9d9707fea" class="cell" data-execution_count="48">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>df_combined_inner.drop(columns <span class="op">=</span> [<span class="st">'precipitation'</span>, <span class="st">'wind_speed'</span>, <span class="st">'dew_point'</span>, <span class="st">'pressure'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="48">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">temperature</th>
<th data-quarto-table-cell-role="th">humidity</th>
<th data-quarto-table-cell-role="th">evapotranspiration</th>
<th data-quarto-table-cell-role="th">soil_temperature</th>
<th data-quarto-table-cell-role="th">median_CO2</th>
<th data-quarto-table-cell-role="th">median_N2O</th>
<th data-quarto-table-cell-role="th">median_CH4</th>
<th data-quarto-table-cell-role="th">median_SF6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1998-11-29</td>
<td>27.191667</td>
<td>81.916667</td>
<td>0.152917</td>
<td>28.200000</td>
<td>366.74</td>
<td>315.59</td>
<td>1803.06</td>
<td>4.351</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1998-12-12</td>
<td>26.566667</td>
<td>81.708333</td>
<td>0.155833</td>
<td>28.033333</td>
<td>367.20</td>
<td>315.59</td>
<td>1799.96</td>
<td>4.351</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1998-12-13</td>
<td>26.458333</td>
<td>86.916667</td>
<td>0.124167</td>
<td>28.000000</td>
<td>367.32</td>
<td>315.59</td>
<td>1800.91</td>
<td>4.351</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1998-12-19</td>
<td>25.895833</td>
<td>73.000000</td>
<td>0.170000</td>
<td>27.800000</td>
<td>367.48</td>
<td>315.59</td>
<td>1799.07</td>
<td>4.351</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1998-12-20</td>
<td>26.479167</td>
<td>73.000000</td>
<td>0.150000</td>
<td>27.800000</td>
<td>367.44</td>
<td>315.59</td>
<td>1807.50</td>
<td>4.351</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022-11-13</td>
<td>27.200000</td>
<td>80.083333</td>
<td>0.153750</td>
<td>29.108333</td>
<td>417.25</td>
<td>337.65</td>
<td>1951.90</td>
<td>11.413</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2022-11-19</td>
<td>26.841667</td>
<td>82.208333</td>
<td>0.155417</td>
<td>29.041667</td>
<td>418.38</td>
<td>337.01</td>
<td>1948.15</td>
<td>11.305</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022-11-20</td>
<td>27.712500</td>
<td>76.291667</td>
<td>0.190000</td>
<td>29.025000</td>
<td>418.48</td>
<td>337.93</td>
<td>1958.26</td>
<td>11.425</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2022-11-26</td>
<td>28.012500</td>
<td>76.666667</td>
<td>0.185833</td>
<td>29.020833</td>
<td>417.81</td>
<td>337.02</td>
<td>1954.00</td>
<td>11.394</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022-11-27</td>
<td>27.841667</td>
<td>76.250000</td>
<td>0.191250</td>
<td>28.983333</td>
<td>417.69</td>
<td>337.51</td>
<td>1952.95</td>
<td>11.405</td>
</tr>
</tbody>
</table>

<p>2408 rows × 8 columns</p>
</div>
</div>
</div>
<div id="f6d5de29-0a34-4886-abbe-ae9e41b8462a" class="cell" data-execution_count="49">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>df_combined_inner.to_csv(<span class="st">'./data/df_combined_inner.csv'</span>, index<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="conclusions" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Conclusions</h1>
<section id="conclusions---descriptive-analysis" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="conclusions---descriptive-analysis"><span class="header-section-number">5.1</span> Conclusions - Descriptive Analysis</h2>
<section id="co2-and-other-greenhouse-gasses" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="co2-and-other-greenhouse-gasses"><span class="header-section-number">5.1.1</span> CO<sub>2</sub> and other Greenhouse Gasses</h3>
<p>Statistics and visualisations show that all four gasses display right-skewed distributions, reflecting <strong>steadily rising atmospheric concentrations</strong>; the farther the mean sits above the mode, the stronger the upward trend has been.</p>
<p>Most importangly and noticeably, CO₂’s slight bimodality hints at a structural shift in the record, matching the well-known <em>acceleration of emissions after the mid-20th century</em>.</p>
<p>Occasional high outliers in CH₄ and SF₆ (range ≫ IQR) point to <em>episodic emission pulses; e.g., large leaks, fires, or industrial releases.</em></p>
<p>N₂O is the most stable series—its tight, near-symmetric distribution suggests slower, steadier increases compared with the other gases.</p>
</section>
<section id="co2-and-weather-data" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="co2-and-weather-data"><span class="header-section-number">5.1.2</span> CO<sub>2</sub> and Weather Data</h3>
<p>The pairplots between CO₂ and the weather provide insights into the interrelated patterns.</p>
<p>First, the upper tail a.k.a. the growing concentratiosn up to 420 ppm, signal the long-term rise.</p>
<p><em>CO₂ and. temperature</em> - the right slanted cloud indicates that higher air temperatures tends to coincide with higher CO₂, which means there is a mild positive linear relationship; The same logic and pattern shows weak inverse association with <em>relative humidity</em>.</p>
<p><em>Wind</em> disperses CO₂ - stronger winds tilt the trend line downward, showing they dilute CO₂ locally.</p>
</section>
</section>
<section id="conclusions---correlation-analysis" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="conclusions---correlation-analysis"><span class="header-section-number">5.2</span> Conclusions - Correlation Analysis</h2>
<section id="analyzing-the-reson-of-pearson-kendall-and-granger" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="analyzing-the-reson-of-pearson-kendall-and-granger"><span class="header-section-number">5.2.1</span> Analyzing the reson of Pearson, Kendall and Granger</h3>
<p>Why Pearson &amp; Kendall Show Weak Correlation, but Granger Shows Strong Causality</p>
<p>The difference lies in how these methods assess relationships.</p>
<p>Pearson and Kendall Correlation measure instantaneous relationships between variables.</p>
<p>Pearson detects linear relationships at a single point in time.</p>
<p>Kendall identifies monotonic (rank-based) relationships, also without considering time. These methods may miss important connections when variables affect each other with a delay — common in climate systems.</p>
<p>Granger Causality captures temporal dependencies. It tests whether past values of one variable help predict future values of another. This makes it ideal for climate data, where effects often appear gradually over weeks or months.</p>
<p>Examples of Delayed Causality in Climate Data</p>
<p>Temperature → CO₂: Rising temperatures can lead to higher CO₂ through ocean release or plant respiration, but the effect is delayed.</p>
<p>Humidity → CO₂: Changes in humidity impact cloud cover and soil moisture, influencing CO₂ absorption over time.</p>
<p>Methane → CO₂: CH₄ breaks down into CO₂, with the effect appearing months later.</p>
<p>Granger Causality reveals these lagged effects, while static correlations like Pearson and Kendall may overlook them.</p>
</section>
<section id="analyzing-stationarity-check-augmented-dickey-fuller-test" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="analyzing-stationarity-check-augmented-dickey-fuller-test"><span class="header-section-number">5.2.2</span> Analyzing Stationarity Check (<i>Augmented Dickey-Fuller Test</i>)</h3>
<p>CO₂ (<code>median_C2O</code>) is non-stationary. This means CO₂ has a trend and may need differencing to make it stationary before modeling. Although the meteorological data is mostly stationary, the gas related datasets (<code>N₂O</code>, <code>CH₄</code>, and <code>SF₆</code>) are non-stationary.</p>
</section>
<section id="analyzing-granger-causality-p-values-across-1-12-lags" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="analyzing-granger-causality-p-values-across-1-12-lags"><span class="header-section-number">5.2.3</span> Analyzing Granger Causality (<i>p-values across 1-12 lags</i>)</h3>
<p>Lower p-values (&lt; 0.05) indicate strong causality. The smaller the p-value, the more significant the predictive relationship.</p>
<ul>
<li><strong>Temperature</strong> - Strong causality across all lags - Predicts future CO₂ trends</li>
<li><strong>Relative Humidity</strong> - Significant up to lag 12 - Influences CO₂ levels, but weaker than temperature</li>
<li><strong>N₂O</strong> - Significant causality at longer lags - Has a delayed effect on CO₂</li>
<li><strong>CH₄</strong> Very strong causality - CH₄ changes predict CO₂ variations</li>
<li><strong>SF₆</strong> Moderate causality at higher lags - SF₆ shows long-term predictive power</li>
</ul>
<p>Temperature and CH₄ have a very strong causal effect and are the strongest predictor of CO₂</p>
<p>The p-values are extremely low, suggesting that past temperature values contain significant information about future CO₂ levels.</p>
<p>This makes sense since methane (CH₄) and CO₂ are both greenhouse gases affected by similar processes.</p>
<p>Humidity, N₂O, and SF₆ also predict CO₂, but to a lesser extent.</p>
</section>
<section id="key-observations-from-1-year-lagged-correlation-analysis" class="level3" data-number="5.2.4">
<h3 data-number="5.2.4" class="anchored" data-anchor-id="key-observations-from-1-year-lagged-correlation-analysis"><span class="header-section-number">5.2.4</span> Key Observations from 1-Year Lagged Correlation Analysis</h3>
<ul>
<li><p>Temperature (temperature_2m (°C) shows a periodic pattern, with correlation peaks at approximately 90, 180, and 360 days. This indicates a seasonal influence, where earlier temperature shifts precede changes in CO₂, likely driven by vegetation cycles, ocean uptake, or energy demand patterns.</p></li>
<li><p>Relative Humidity (relative_humidity_2m (%)) displays a weak but consistent negative lagged correlation. This suggests that increased humidity may lead to reduced CO₂ levels over time, potentially due to enhanced photosynthetic activity.</p></li>
<li><p>N₂O (median_N2O) exhibits delayed positive correlation with CO₂. This may reflect shared industrial and combustion-related emission sources, where increases in N₂O are followed by CO₂ rises.</p></li>
<li><p>CH₄ (value_CH4) shows a strong positive lagged correlation. Methane contributes to greenhouse warming and chemically converts to CO₂ in the atmosphere, explaining its predictive relationship.</p></li>
<li><p>SF₆ (median_SF6) presents the most stable and persistent correlation with CO₂, indicating long-lived co-emission patterns and alignment with global industrial activity.</p></li>
</ul>
<section id="interpretation" class="level4" data-number="5.2.4.1">
<h4 data-number="5.2.4.1" class="anchored" data-anchor-id="interpretation"><span class="header-section-number">5.2.4.1</span> Interpretation</h4>
<p>Temperature and methane emerge as the strongest lagged predictors of CO₂.</p>
<p>The observed delays, spanning from 90 to 360 days, highlight seasonal and systemic effects not captured by instantaneous correlation methods.</p>
<p>Industrial gases like N₂O and SF₆ reveal longer-term trends aligned with CO₂ dynamics, while meteorological variables reflect shorter, cyclical influences.</p>
</section>
</section>
<section id="key-observations-from-5-year-lagged-correlation-analysis" class="level3" data-number="5.2.5">
<h3 data-number="5.2.5" class="anchored" data-anchor-id="key-observations-from-5-year-lagged-correlation-analysis"><span class="header-section-number">5.2.5</span> Key Observations from 5-Year Lagged Correlation Analysis</h3>
<ul>
<li><p>Temperature (temperature_2m (°C) displays strong multi-year periodicity, with clear peaks approximately every 365 days. This pattern reflects annual climate cycles that influence CO₂ variability through temperature-driven processes.</p></li>
<li><p>Relative Humidity (relative_humidity_2m (%)) exhibits an inverse cyclical pattern relative to temperature. The negative correlation suggests that higher humidity is associated with lower future CO₂ levels, potentially due to enhanced vegetation uptake and precipitation-related processes.</p></li>
<li><p>CH₄ (value_CH4) and SF₆ (median_SF6) maintain consistently strong positive correlations over multiple years, indicating stable long-term relationships with CO₂, likely driven by common emission sources or atmospheric persistence.</p></li>
<li><p>N₂O (median_N2O) shows sustained long-term correlation with CO₂, reflecting delayed but consistent influence, possibly due to overlapping industrial emission patterns.</p></li>
</ul>
<section id="interpretation-1" class="level4" data-number="5.2.5.1">
<h4 data-number="5.2.5.1" class="anchored" data-anchor-id="interpretation-1"><span class="header-section-number">5.2.5.1</span> Interpretation</h4>
<p>The presence of pronounced annual cycles and persistent long-term correlations highlights the importance of incorporating seasonality and delayed effects in CO₂ forecasting models.</p>
<p>Both natural and anthropogenic drivers contribute to the observed lagged dynamics.</p>
</section>
</section>
<section id="key-observations-from-10-year-lagged-correlation-analysis" class="level3" data-number="5.2.6">
<h3 data-number="5.2.6" class="anchored" data-anchor-id="key-observations-from-10-year-lagged-correlation-analysis"><span class="header-section-number">5.2.6</span> Key Observations from 10-Year Lagged Correlation Analysis</h3>
<ul>
<li><p>Temperature (temperature_2m (°C) exhibits strong annual oscillations, with clear periodic peaks every ~365 days. These patterns indicate persistent seasonal and multi-year influences on CO₂ concentrations.</p></li>
<li><p>Relative Humidity (relative_humidity_2m (%)) shows an inverse correlation to temperature over time. The negative relationship suggests that increased humidity leads to lower future CO₂, likely due to enhanced vegetation growth, precipitation, and natural carbon sink activity.</p></li>
<li><p>N₂O (median_N2O) and SF₆ (median_SF6) maintain stable, positive correlations with CO₂ across several years, indicating long-term alignment through shared industrial emission sources and slow atmospheric accumulation.</p></li>
<li><p>CH₄ (value_CH4) displays strong correlation in the short to medium term, with a gradual decline beyond the first few years. This suggests a diminishing influence on CO₂ over longer horizons.</p></li>
<li><p>Beyond 2,500–3,500 days (7–10 years), correlations across all variables become less stable and more variable. This may reflect the influence of external factors such as climate shifts, regulatory changes, or model limitations at extended time scales.</p></li>
</ul>
<section id="interpretation-2" class="level4" data-number="5.2.6.1">
<h4 data-number="5.2.6.1" class="anchored" data-anchor-id="interpretation-2"><span class="header-section-number">5.2.6.1</span> Interpretation</h4>
<p>Annual cycles remain clearly evident and should be incorporated into long-term CO₂ forecasting models.</p>
<p>Humidity exerts a delayed inverse influence, potentially linked to its role in regulating carbon sinks.</p>
<p>Industrial gases, particularly CH₄, N₂O, and SF₆, are more relevant for mid-term prediction horizons (1–5 years), while longer-term variability introduces additional uncertainty.</p>
</section>
</section>
</section>
</section>
<section id="continue-to-prediction-models" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> <a href="./models.html">Continue to Prediction Models 🔗</a></h1>
<p>Prediction models were developed based on this data and can be explored in the other notebook.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>